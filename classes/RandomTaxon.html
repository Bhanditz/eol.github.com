<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Class: RandomTaxon [Rails Application Documentation]</title>
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <link href='.././rdoc-style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>Class</span>
          RandomTaxon
        </h1>
        <ol class='paths'>
          <li>
            <a href="../files/app/models/random_taxon_rb.html">app/models/random_taxon.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a href="SpeciesSchemaModel.html">SpeciesSchemaModel</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>public class</h3>
            <ol>
              <li><a href="#M000575">random</a></li>
              <li><a href="#M000574">random_set</a></li>
              <li><a href="#M000576">reset_count</a></li>
            </ol>
            <h3>public instance</h3>
            <ol>
              <li><a href="#M000577">name</a></li>
              <li><a href="#M000580">smart_image</a></li>
              <li><a href="#M000579">smart_medium_thumb</a></li>
              <li><a href="#M000578">smart_thumb</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public class methods</h2>
              <div class='public-class method' id='method-M000575'>
                <a name='M000575'>      </a>
                <div class='synopsis'>
                  <span class='name'>random</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  The first one takes a little longer, since it needs to populate the class
                  variables. But after that, it&#8217;s quite fast:
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000575-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000575-source'>    <span class="ruby-comment cmt"># File app/models/random_taxon.rb, line 29</span>&#x000A;29:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">random</span>()&#x000A;30:     <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">random_set</span>(<span class="ruby-value">1</span>)[<span class="ruby-value">0</span>]&#x000A;31:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000574'>
                <a name='M000574'>      </a>
                <div class='synopsis'>
                  <span class='name'>random_set</span>
                  <span class='arguments'>(limit = 10)</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000574-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000574-source'>    <span class="ruby-comment cmt"># File app/models/random_taxon.rb, line 17</span>&#x000A;17:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">random_set</span>(<span class="ruby-identifier">limit</span> = <span class="ruby-value">10</span>)&#x000A;18:     <span class="ruby-identifier">list</span> = []&#x000A;19:     &#x000A;20:     <span class="ruby-constant">RandomTaxon</span>.<span class="ruby-identifier">reset_count</span>&#x000A;21:     <span class="ruby-identifier">starting_id</span> = <span class="ruby-identifier">rand</span>(<span class="ruby-ivar">@@count</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">limit</span>).<span class="ruby-identifier">floor</span>&#x000A;22:     <span class="ruby-identifier">list</span> = <span class="ruby-constant">RandomTaxon</span>.<span class="ruby-identifier">find_by_sql</span>([<span class="ruby-value str">'SELECT * FROM random_taxa LIMIT ?, ?'</span>,&#x000A;23:                                     <span class="ruby-identifier">starting_id</span>, <span class="ruby-identifier">limit</span>])&#x000A;24: &#x000A;25:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">list</span>&#x000A;26:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-class method' id='method-M000576'>
                <a name='M000576'>      </a>
                <div class='synopsis'>
                  <span class='name'>reset_count</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  <p>
                  NOTE - This is difficult to test with specs. To test manually: 1)
                  script/console 2) <a href="RandomTaxon.html#M000575">RandomTaxon.random</a>
                  should give you a taxon. 3) mysql; delete from random_taxa; 4) <a
                  href="RandomTaxon.html#M000575">RandomTaxon.random</a> should raise
                  &#8220;There are no Random Taxa in the database&#8221;. DO NOT close your
                  console! 5) rake denormal:build_random_taxa 6) <a
                  href="RandomTaxon.html#M000575">RandomTaxon.random</a> should give you a
                  taxon again.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000576-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000576-source'>    <span class="ruby-comment cmt"># File app/models/random_taxon.rb, line 42</span>&#x000A;42:   <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">reset_count</span>&#x000A;43:     <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@@last_cleared</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@@last_cleared</span>.<span class="ruby-identifier">advance</span>(<span class="ruby-identifier">:hours=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>&#x000A;44:       <span class="ruby-ivar">@@last_cleared</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>()&#x000A;45:       <span class="ruby-ivar">@@count</span> = <span class="ruby-constant">SpeciesSchemaModel</span>.<span class="ruby-identifier">connection</span>.<span class="ruby-identifier">select_value</span>(<span class="ruby-value str">'select count(*) count from random_taxa'</span>).<span class="ruby-identifier">to_i</span>&#x000A;46:     <span class="ruby-keyword kw">end</span>&#x000A;47:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <h2>Public instance methods</h2>
              <div class='public-instance method' id='method-M000577'>
                <a name='M000577'>      </a>
                <div class='synopsis'>
                  <span class='name'>name</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='description'>
                  <p>
                  So, if we just called name(), return our cached version; otherwise,
                  delegate to HE.
                  </p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000577-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000577-source'>    <span class="ruby-comment cmt"># File app/models/random_taxon.rb, line 50</span>&#x000A;50:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">name</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)&#x000A;51:     <span class="ruby-identifier">args</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-value">? </span><span class="ruby-keyword kw">self</span>[<span class="ruby-identifier">:name</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">taxon_concept</span>.<span class="ruby-identifier">name</span>(<span class="ruby-identifier">args</span>[<span class="ruby-value">0</span>], <span class="ruby-identifier">args</span>[<span class="ruby-value">1</span>])&#x000A;52:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000580'>
                <a name='M000580'>      </a>
                <div class='synopsis'>
                  <span class='name'>smart_image</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000580-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000580-source'>    <span class="ruby-comment cmt"># File app/models/random_taxon.rb, line 63</span>&#x000A;63:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">smart_image</span>&#x000A;64:     <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">image_url</span>&#x000A;65:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000579'>
                <a name='M000579'>      </a>
                <div class='synopsis'>
                  <span class='name'>smart_medium_thumb</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000579-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000579-source'>    <span class="ruby-comment cmt"># File app/models/random_taxon.rb, line 58</span>&#x000A;58:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">smart_medium_thumb</span>&#x000A;59:     <span class="ruby-comment cmt">#return thumb_url.sub(/_small\.png/, '_medium.png')</span>&#x000A;60:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">data_object</span>.<span class="ruby-identifier">smart_medium_thumb</span>&#x000A;61:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
              <div class='public-instance method' id='method-M000578'>
                <a name='M000578'>      </a>
                <div class='synopsis'>
                  <span class='name'>smart_thumb</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('M000578-source'); return false">
                    [show source]
                  </a>
                  <pre id='M000578-source'>    <span class="ruby-comment cmt"># File app/models/random_taxon.rb, line 54</span>&#x000A;54:   <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">smart_thumb</span>&#x000A;55:     <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">data_object</span>.<span class="ruby-identifier">smart_thumb</span>&#x000A;56:   <span class="ruby-keyword kw">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
